---
import { getMediaPaginatedPhotos } from '../utils/wordpress-media-api';

const url = new URL(Astro.request.url);
const currentPage = parseInt(url.searchParams.get('page') || '1');

console.log(`Debug: Requested page = ${currentPage}`);

let debugInfo = {};
let error = null;

try {
  const result = await getMediaPaginatedPhotos(currentPage, 9);
  
  debugInfo = {
    requestedPage: currentPage,
    returnedPage: result.currentPage,
    photosCount: result.photos.length,
    firstPhotoId: result.photos[0]?.id,
    lastPhotoId: result.photos[result.photos.length - 1]?.id,
    photoIds: result.photos.map(p => p.id),
    totalPhotos: result.totalPhotos,
    totalPages: result.totalPages
  };
  
} catch (err: any) {
  error = err.message;
}
---

<!DOCTYPE html>
<html>
<head>
  <title>Page Debug - Page {currentPage}</title>
  <style>
    body { font-family: monospace; margin: 40px; }
    .error { color: red; }
    .success { color: green; }
    .warning { color: orange; }
    pre { background: #f5f5f5; padding: 20px; overflow-x: auto; }
  </style>
</head>
<body>
  <h1>Debug para Página {currentPage}</h1>
  
  {error && (
    <div class="error">
      <h2>❌ Error:</h2>
      <p>{error}</p>
    </div>
  )}
  
  <h2>Información:</h2>
  <pre>{JSON.stringify(debugInfo, null, 2)}</pre>
  
  <h2>Enlaces de prueba:</h2>
  <p>
    <a href="/page-debug?page=1">Página 1</a> | 
    <a href="/page-debug?page=2">Página 2</a> | 
    <a href="/page-debug?page=3">Página 3</a> | 
    <a href="/page-debug?page=4">Página 4</a>
  </p>
  
  <p><a href="/">← Volver al inicio</a></p>
</body>
</html>
