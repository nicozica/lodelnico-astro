<!DOCTYPE html>
<html>
<head>
    <title>Date Format Test</title>
</head>
<body>
    <h1>Date Format Test</h1>
    
    <div class="photo-date" data-raw-date="2025-08-28T06:25:49">
        <noscript>28 de agosto de 2025</noscript>
        <span class="js-date">Loading...</span>
    </div>
    
    <script>
        console.log('Script starting...');
        
        function formatPhotoDate() {
            console.log('formatPhotoDate called');
            const dateElements = document.querySelectorAll('.photo-date[data-raw-date]');
            console.log('Found date elements:', dateElements.length);
            
            dateElements.forEach((element, index) => {
                const rawDate = element.getAttribute('data-raw-date');
                const jsDateSpan = element.querySelector('.js-date');
                const targetElement = jsDateSpan || element;
                
                console.log(`Processing element ${index}, raw date:`, rawDate);
                
                if (rawDate) {
                    try {
                        const date = new Date(rawDate);
                        console.log('Parsed date:', date);
                        
                        if (isNaN(date.getTime())) {
                            throw new Error('Invalid date: ' + rawDate);
                        }
                        
                        const formatted = new Intl.DateTimeFormat('es-AR', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit',
                            hour12: false,
                            timeZone: 'America/Argentina/Buenos_Aires'
                        }).format(date);
                        
                        console.log('Formatted date:', formatted);
                        targetElement.textContent = formatted;
                        
                    } catch (error) {
                        console.error('Error formatting date:', error);
                        targetElement.textContent = 'Error: ' + error.message;
                    }
                } else {
                    console.log('No raw date found');
                    targetElement.textContent = 'Sin fecha';
                }
            });
        }

        // Run when DOM is ready
        if (document.readyState === 'loading') {
            console.log('DOM still loading, adding event listener');
            document.addEventListener('DOMContentLoaded', formatPhotoDate);
        } else {
            console.log('DOM already loaded, running immediately');
            formatPhotoDate();
        }
    </script>
</body>
</html>
