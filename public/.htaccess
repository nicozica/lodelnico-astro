# Apache configuration for Astro static site
# Ensures proper routing for directory-based build output

Options -MultiViews
DirectoryIndex index.html

# Custom error pages
ErrorDocument 404 /404/

<IfModule mod_rewrite.c>
RewriteEngine On

# Redirect root to first gallery page (invisible to user)
RewriteCond %{REQUEST_URI} ^/$
RewriteRule ^$ /1/ [R=301,L]

# If the file or directory exists, serve it as-is
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# If /path/index.html exists, serve it (preserve query string)
RewriteCond %{DOCUMENT_ROOT}/$1/index.html -f
RewriteRule ^(.+)$ $1/index.html [QSA,L]

# Optional fallback to root index.html for unmatched routes
# RewriteRule . /index.html [QSA,L]
</IfModule>
